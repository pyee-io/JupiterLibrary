var JupiterDoc=function(){"use strict";const e=(e,t)=>Number(Math.round(e+"e"+t)+"e-"+t),t=e=>e?e.toLowerCase().replace(/[\s()-]+/g,"_").replace(/_+$/,""):null;var a=e,n=(e,t)=>{var a=t.find((t=>t.name===e));return a?a.id:null},s=(e,t,a)=>{var n=a.find((t=>t.name===e));if(n)var s=n.fieldTypes.find((e=>e.name===t));return s?s.id:null},r=(e,t)=>{e.facts&&e.facts.forEach((e=>{const a=t.find((t=>t.id===e.factTypeId));a&&(e.factTypeName=a.name,e.allowMultiple=a.allowMultiple,e.fieldCount=a.fieldTypes.length),e.fields&&e.fields.forEach((a=>{const n=t.find((t=>t.id===e.factTypeId)).fieldTypes.find((e=>e.id===a.factFieldTypeId));n&&(a.factTypeFieldName=n.name,a.dataType=n.dataType)}))}))},i=(e,t,a,n)=>{const s=e.facts?e.facts.find((e=>e.factTypeId==t)):null;if(s){const e=s.fields.find((e=>e.factFieldTypeId==a));if(e)switch(n){case"date":return new luxon.DateTime.fromISO(e.dateValue);case"number":return e.numberValue;case"string":return e.stringValue;case"bool":return e.booleanValue;default:return null}}return null},o=(e,t)=>{const a=e.facts?e.facts.find((e=>e.factTypeId==t)):null;return a?a.id:null},_=(e,t,a)=>{const n=e.facts?e.facts.find((e=>e.factTypeId==t)):null;if(n){const e=n.fields.find((e=>e.factFieldTypeId==a));if(e)return e.id}return null},d=(e,a)=>{const n=e.facts?e.facts.filter((e=>e.factTypeId===a)):null;if(!n)return null;const s=[];return n.forEach((a=>{const n={};if(n.id=a.id,!a.fields)return n;a.fields.forEach((e=>{var a=t(e.factTypeFieldName),s="";switch(e.dataType){case"Number":s=e.numberValue;break;case"Date":s=new luxon.DateTime.fromISO(e.dateValue);break;case"String":case"SelectList":s=e.stringValue;break;case"Boolean":s=e.booleanValue}n[a]=s})),n.source_doc_id=e.id,s.push(n)})),s},m=(e,a)=>{const n=e.facts?e.facts.find((e=>e.factTypeId==a)):null;if(!n||!n.fields)return null;const s={};return s.fact_id=n.id,n.fields.forEach((e=>{var a=t(e.factTypeFieldName),n="";switch(e.dataType){case"Number":n=e.numberValue;break;case"Date":n=new luxon.DateTime.fromISO(e.dateValue);break;case"String":case"SelectList":n=e.stringValue;break;case"Boolean":n=e.booleanValue}n&&(s[a]=n)})),s},l=(e,t)=>e&&t?e.ts<t.ts?e:t:e||(t||null),c=e=>{if(0===e.length)return null;var t=e[0];return e.forEach((e=>{(!t||e?.ts<t?.ts)&&(t=e)})),t},p=(t,a,n)=>e(t*Math.pow(1+a,n),4),u=e=>12*e%1==0&&e<1?{months:12*e}:e%1!=0&&12*e%1==0&&e>1?{years:Math.floor(e),months:12*e%12}:{years:e},h=(t,a,n,s,r,i,o,_=!1)=>{var d=[];let m;m="Start next Jan 1 after Term commencement"==o?t.set({year:t.year+1,month:1,day:1}):"Start 1st of month after commencement"==o?t.plus({months:1}).set({day:1}):t;for(var l=t;l<=a;){var c=l.daysInYear,p=Math.floor(l.diff(s,"years").years),u=i*Math.pow(1+r,p),h=l.year-m.year;h=l<m||n&&l.year===m.year?1:l.year-m.year+1;var y={};y.date=l.toFormat("yyyy-MM-dd"),y.annual_cost=u,y.daily_cost=u/c,y.payment_index=h,d.push(y),l=l.plus({days:1})}const f=Object.values(d.reduce(((e,t)=>{const{payment_index:a,daily_cost:n,date:s}=t;return e[a]=e[a]||{payment_index:a,total_payment:0,min_date:s,max_date:s,date_count:0},e[a].total_payment+=n,s<e[a].min_date&&(e[a].min_date=s),s>e[a].max_date&&(e[a].max_date=s),e[a].date_count+=1,e}),{}));return _&&console.log("results",f),f.map((t=>({payment_index:t.payment_index,payment_date:t.min_date,total_payment:e(t.total_payment,2),min_date:t.min_date,max_date:t.max_date,date_count:t.date_count})))};const y={Assignment:"ASGMT",Easement:"ESMNT","Farm and Ranch Contract":"FRC","Interconnection Agreement":"INTCON",Lease:"LEASE","Lease Option":"LOPT","Purchase and Sale Agreement":"AOS","Purchase Option":"POPT"};return class{constructor(e,t,a=[],l=[]){this.cleanDoc(e),r(e,t),this.rawDoc=e,this.id=e.id,this.name=e.name;var c=a.find((t=>t.id===e.documentTypeId));this.document_type=c?c.name:null,this.agreement_id=i(e,n("Agreement ID",t),s("Agreement ID","Agreement ID",t),"string"),this.project_id=i(e,n("Project ID",t),s("Project ID","Project ID",t),"string"),this.project_name=i(e,n("Project Name",t),s("Project Name","Project Name",t),"string"),this.jupiter_entity=i(e,n("Jupiter Entity",t),s("Jupiter Entity","Jupiter Entity",t),"string"),this.grantee=i(e,n("Grantee/Lessee",t),s("Grantee/Lessee","Grantee/Lessee",t),"string"),this.grantor=d(e,n("Grantor/Lessor",t)),this.effective_date=i(e,n("Effective Date",t),s("Effective Date","Effective Date",t),"date"),this.amendment_date=i(e,n("Amendment Date",t),s("Amendment Date","Amendment Date",t),"date"),this.deed_date=i(e,n("Deed Date",t),s("Deed Date","Deed Date",t),"date"),this.payment_directive_date=i(e,n("Payment Directive Date",t),s("Payment Directive Date","Payment Directive Date",t),"date"),this.recorded_date=i(e,n("Recorded Date",t),s("Recorded Date","Recorded Date",t),"date"),this.letter_date=i(e,n("Letter Date",t),s("Letter Date","Letter Date",t),"date"),this.outside_date=i(e,n("Outside Date",t),s("Outside Date","Outside Date",t),"date"),this.full_purchase_price=i(e,n("Full Purchase Price",t),s("Full Purchase Price","Full Purchase Price",t),"number"),this.estimated_closing_date=i(e,n("Estimated Closing Date",t),s("Estimated Closing Date","Estimated Closing Date",t),"date"),this.date_closed=i(e,n("Date Closed",t),s("Date Closed","Date Closed",t),"date"),this.terminated=i(e,n("Terminated",t),s("Terminated","Terminated",t),"bool"),this.property_description=d(e,n("Property Description",t)),this.total_controlled_acres=this.property_description.reduce(((e,t)=>e+(t.exclude_acres_from_controlled_acres?0:t.agreement_acres)||0),0),this.notice_details=i(e,n("Notice Details",t),s("Notice Details","Notice Details",t),"string"),this.operational_details=m(e,n("Operational Details",t))??{},this.agreement_terms=d(e,n("Agreement Term",t)),this.term_payment_models=d(e,n("Payment Model - Term Based",t)),this.date_payment_models=d(e,n("Payment Model - Date Based",t)),this.date_payments=[],this.tags=this.getTags(l),this.termination=m(e,n("Termination",t))??{},this.associated_agreements=d(e,n("Associated Agreements",t)),this.review_status=i(e,n("Review Status",t),s("Review Status","Review Status",t),"string"),this.review_status_notes=i(e,n("Review Status",t),s("Review Status","Notes",t),"string"),this.review_status_instance_id=o(e,n("Review Status",t)),this.review_status_value_instance_id=_(e,n("Review Status",t),s("Review Status","Review Status",t)),this.agreement_group=i(e,n("Agreement Group",t),s("Agreement Group","Agreement Group",t),"string"),this.calcAgreementTermDates(this.agreement_terms,this.effective_date,this.operational_details,this.termination),this.qc_flags=[],this.libraryVersion="1.1.33"}calcAgreementGroup(){return this.grantor[0]&&"Complete"!==!this.review_status&&this.project_id&&this.project_name&&this.document_type&&!this.amendment_date?`${y[this.document_type]} - ${this.project_name} - ${this.nicknameGrantor(this.grantor[0]["grantor/lessor_name"])} - ${this.project_id}`:null}getTags(e){var t=[];return this.rawDoc.tagIds.forEach((a=>{e.find((e=>e.id===a))&&t.push(e.find((e=>e.id===a)).name)})),t}calcAgreementTermDates(e,t,a,n){(t||a.commencement_date)&&(n=n||{},a=a||{},e.sort(((e,t)=>e.term_ordinal-t.term_ordinal)).forEach(((s,r)=>{if("Construction"===s.term_type&&!s.extension&&a.construction_commencement?s.start_date=a.construction_commencement:"Operations"===s.term_type&&!s.extension&&a.operations_commencement?s.start_date=a.operations_commencement:s.start_date=e[r-1]?.end_date.plus({days:1})||a.commencement_date||t,s.start_date_text=s.start_date.toFormat("MM/dd/yyyy"),s.term_length_years)i=u(s.term_length_years);else var i={days:0};var o=s.start_date.plus(i);if(o=o.plus({days:o.c.hour>=12?1:0}).startOf("day"),s.end_date=l(n?.termination_date,o.plus({days:-1})),"Construction"!==s.term_type&&"Operations"!==s.term_type){var _=l(a.construction_commencement,a.operations_commencement);_&&(s.start_date.ts>=_.ts?s.cancelled_by_ops=!0:s.end_date.ts>=_.ts&&(s.end_date=_.plus({days:-1})))}else"Construction"===s.term_type&&a.operations_commencement&&s.end_date.ts>=a.operations_commencement.ts&&(s.end_date=a.operations_commencement.plus({days:-1}));s.end_date_text=s.end_date.toFormat("MM/dd/yyyy"),s.cumulative_increase_amount=e.filter((e=>e.term_ordinal<=s.term_ordinal&&e.payment_model===s.payment_model)).reduce(((e,t)=>e+(t.increase_amount??0)),0),s.cumulative_escalation_rate=e.filter((e=>e.term_ordinal<=s.term_ordinal&&e.payment_model===s.payment_model)).reduce(((e,t)=>e*(1+(t.escalation_rate??0)/100)),1)})),this.final_term_end_date=e[e.length-1]?.end_date.toFormat("M/d/yyyy"))}periodicBasePayment(e,t,a,n,s){if(!e)return 0;t||(t={mw:0,inverter_count:0,inverter_rating_mvas:0});var r=Math.max(e.minimum_payment??0,(e.payment_per_mw??0)*(t.mw??0),(t.inverter_count??0)*(t.inverter_rating_mvas??0)*(e.payment_per_mva??0),e.flat_payment_amount??0,(e.payment_per_acre??0)*(s??0));return r=(r+n)*a}termPaymentModel(e,t){if(!t||0===t.length)return null;const a=e.payment_model??e.term_type;return a?t.find((e=>e.model_type===a)):t[0]}calcPaymentPeriodEnd(e,t,a,n){var s;return a?"Annually"===t?s=new luxon.DateTime.local(e.year,12,31):"Quarterly"===t?s=e.plus({months:3}).minus({days:1}):"Monthly"===t&&(s=e.plus({months:1}).minus({days:1})):"Annually"===t?s=e.plus({years:1}).minus({days:1}):"Semiannually"===t?s=e.plus({months:6}).minus({days:1}):"Quarterly"===t?s=e.plus({months:3}).minus({days:1}):"Monthly"===t?s=e.plus({months:1}).minus({days:1}):"Once per Term"===t&&(s=n),s>=n?n:s}calcBlendedPeriodicPaymentsForTerm(e,t,a,n,s,r){if(e.cancelled_by_ops||0===s.length)return null;const i=this.termPaymentModel(e,a);if(!i||!e.start_date||!e.end_date)return null;const o=this.periodicBasePayment(i,t,e.cumulative_escalation_rate,e.cumulative_increase_amount,n),_=this.agreement_terms.filter((t=>t.term_ordinal<e.term_ordinal&&t.payment_model===e.payment_model)),d=_?.sort(((e,t)=>e.term_ordinal-t.term_ordinal))[0]?.start_date??e.start_date;return h(e.start_date,e.end_date,i.prorated_first_period,d,i.periodic_escalation_rate/100,o,e.first_payment_start).map((t=>{var a=null;return a=0!==t.payment_index||!i.first_payment_lag||e.extension&&!i.apply_payment_lag_to_extension?t._payment_index>0&&i.subsequent_payment_lag&&(!e.extension||i.apply_payment_lag_to_extension)?payment_date.plus({days:i.subsequent_payment_lag}):null:t.payment_date.plus({days:i.first_payment_lag}),s.map((n=>({payment_source:"Term Model",model_id:i.id,project_id:r,payment_index:t.payment_index,payment_date:t.payment_date.toLocaleString(),late_payment_date:a?.toLocaleString()||null,payment_type:`${e.term_type}${e.extension?" (ext)":""} Term Payment`,payment_amount:t.total_payment*((n.payment_split??100)/s.length/100),payee:i.payee??this.nicknameGrantor(n["grantor/lessor_name"]),payment_period_start:t.min_date,payment_period_end:t.max_date,prorata_factor:t.date_count/t.payment_date.daysInYear,applicable_to_purchase:i.applicable_to_purchase,refundable:!1,after_outside_date:!!this.outside_date&&t.payment_date.ts>this.outside_date.ts,previous_periods:null})))})).flat()}calcPeriodicPaymentsForTerm(e,t,n,s,r,i){if(e.cancelled_by_ops||0===r.length)return null;const o=[],_=this.termPaymentModel(e,n),d=this.periodicBasePayment(_,t,e.cumulative_escalation_rate,e.cumulative_increase_amount,s);if(!_||!e.start_date||!e.end_date)return null;var m,l,c,u=0,h=e.start_date,y=_.periodic_escalation_rate??0,f=0,g=0;switch("Annually"===_.periodic_escalation_frequency&&(f=this.agreement_terms.filter((t=>t.term_ordinal<e.term_ordinal&&t.payment_model===e.payment_model)),g=f?.reduce(((e,t)=>e+t.term_length_years),0)),e.first_payment_start){case"Start with Term":l=e.start_date;break;case"Start next Jan 1 after Term commencement":l=new luxon.DateTime.local(e.start_date.year+1,1,1);break;case"Start 1st of month after commencement":l=new luxon.DateTime.local(h.year,h.month,1).plus({months:1});break;default:l=e.first_payment_date??e.start_date}for(;h<e.end_date&&!(this.date_closed&&h>this.date_closed);){if(!(c=this.calcPaymentPeriodEnd(l,_.payment_frequency,_.prorated_first_period,e.end_date)))return;var v;m="Annually"===_.payment_frequency?a(c.plus({days:1}).diff(h,"years").years,4):"Semiannually"===_.payment_frequency?a(c.plus({days:1}).diff(h,"months").months/6,4):"Quarterly"===_.payment_frequency?a(c.plus({days:1}).diff(h,"quarters").quarters,4):"Monthly"===_.payment_frequency?a(c.plus({days:1}).diff(h,"months").months,4):1;var D={Annually:1,Semiannually:2,Quarterly:4,Monthly:12};v=_.payment_frequency&&_.periodic_escalation_frequency?D[_.payment_frequency]/D[_.periodic_escalation_frequency]:1;var P=null;P=0!==u||!_.first_payment_lag||e.extension&&!_.apply_payment_lag_to_extension?u>0&&_.subsequent_payment_lag&&(!e.extension||_.apply_payment_lag_to_extension)?l.plus({days:_.subsequent_payment_lag}):null:l.plus({days:_.first_payment_lag}),r.forEach((t=>{o.push({payment_source:"Term Model",model_id:_.id,project_id:i,payment_index:u,payment_date:l.toLocaleString(),late_payment_date:P?.toLocaleString()||null,payment_type:`${e.term_type}${e.extension?" (ext)":""} Term Payment`,payment_amount:p((d+(_.increase_amount??0)*u)*((t.payment_split??100/r.length)/100),(y??0)/100,Math.floor((g+u)/v))*m,payee:_.payee??this.nicknameGrantor(t["grantor/lessor_name"]),payment_period_start:h.toLocaleString(),payment_period_end:c.toLocaleString(),prorata_factor:m,applicable_to_purchase:_.applicable_to_purchase,refundable:!1,after_outside_date:!!this.outside_date&&l.ts>this.outside_date.ts,previous_periods:g+u})})),h=c.plus({days:1}),l=c.plus({days:1}),u++}return o.sort(((e,t)=>e.payment_date-t.payment_date)),o}calcAllTermPayments(){this.agreement_terms.forEach((e=>{if(this.term_payment_models){var t=this.termPaymentModel(e,this.term_payment_models);t&&(t.prorated_first_period&&t.periodic_escalation_rate>0?e.periodic_payments=this.calcBlendedPeriodicPaymentsForTerm(e,this.operational_details,this.term_payment_models,this.total_controlled_acres,this.grantor,this.project_id):e.periodic_payments=this.calcPeriodicPaymentsForTerm(e,this.operational_details,this.term_payment_models,this.total_controlled_acres,this.grantor,this.project_id))}}))}calcDatePayments(){this.date_payments=[],this.date_payment_models.forEach((e=>{if((e.date_begin&&e.date_end&&e.frequency||e.date_one_time)&&e.payment_amount&&!(!this.grantor.length>0))for(var t=e.date_one_time??e.date_begin,a=c([this.termination?.termination_date,e.date_one_time,e.date_end]),n=1,s=0,r=e.date_one_time?"Date Model (One Time)":"Date Model";t<=a&&!(this.date_closed&&t>this.date_closed);){s=p(e.payment_amount+(e.increase_amount??0)*(n-1),(e.periodic_escalation_rate??0)/100,n);var i=null;if(1===n&&e.first_payment_lag?i=t.plus({days:e.first_payment_lag}):n>1&&e.subsequent_payment_lag&&(i=t.plus({days:e.subsequent_payment_lag})),this.grantor.forEach((a=>{var o={payment_source:r,model_id:e.id,project_id:this.project_id,payment_index:n-1,payment_date:t.toLocaleString(),late_payment_date:i?.toLocaleString()||null,payment_type:e.payment_type,payment_amount:s*((a.payment_split??100/this.grantor.length)/100),payee:e.payee??this.nicknameGrantor(a["grantor/lessor_name"]),applicable_to_purchase:e.applicable_to_purchase,refundable:e.refundable,after_outside_date:!!this.outside_date&&t.ts>this.outside_date.ts};this.date_payments.push(o)})),n++,"Annually"===e.frequency)t=t.plus({years:1});else if("Semiannually"===e.frequency)t=t.plus({months:6});else if("Quarterly"===e.frequency)t=t.plus({months:3});else{if("Monthly"!==e.frequency)return;t=t.plus({months:1})}}}))}calcEstimatedPurchasePrice(){if(this.full_purchase_price&&(this.estimated_closing_date||this.date_closed)){var e=0;this.agreement_terms.length>0&&this.agreement_terms.forEach((t=>{t.periodic_payments&&(e+=t.periodic_payments.filter((e=>e.applicable_to_purchase))?.reduce(((e,t)=>e+t.payment_amount),0)??0)})),this.date_payments&&(e+=this.date_payments.filter((e=>e.applicable_to_purchase))?.reduce(((e,t)=>e+t.payment_amount),0)??0),(this.date_closed??this.estimated_closing_date)&&this.full_purchase_price&&!this.termination?.termination_date&&this.grantor.forEach((t=>{this.date_payments.push({payment_source:"Purchase Price Calculation",model_id:null,payment_date:(this.date_closed??this.estimated_closing_date).toLocaleString(),payment_type:"Purchase Price",payee:this.nicknameGrantor(t["grantor/lessor_name"]),payment_amount:(this.full_purchase_price-e)*((t.payment_split??100/this.grantor.length)/100),applicable_to_purchase:!0,refundable:!1})}))}}processAmendments(e){if(!this.effective_date)return;const t=e.filter((e=>this.agreement_group&&e.agreement_group===this.agreement_group&&(e.amendment_date||e.letter_date||e.deed_date||e.payment_directive_date||e.recorded_date)&&e.id!==this.id));if(t.length>0){t.filter((e=>e.amendment_date)).sort(((e,t)=>new Date(e.amendment_date)-new Date(t.amendment_date))).map(((e,t)=>e.amendment_ordinal=t+1));for(const e of t)e.effective_date&&(this.effective_date=e.effective_date),e.outside_date&&(this.outside_date=e.outside_date),e.property_description?.length>0&&(this.property_description=e.property_description),e.jupiter_entity&&(this.jupiter_entity=e.jupiter_entity),e.grantee&&(this.grantee=e.grantee),e.grantor&&e.grantor?.length>0&&(this.grantor=e.grantor),e.full_purchase_price&&(this.full_purchase_price=e.full_purchase_price),e.estimated_closing_date&&(this.estimated_closing_date=e.estimated_closing_date),e.date_closed&&(this.date_closed=e.date_closed),e.agreement_terms&&e.agreement_terms.length>0&&(this.agreement_terms=e.agreement_terms),e.term_payment_models&&e.term_payment_models.length>0&&(this.term_payment_models=e.term_payment_models),Object.keys(e.termination).length>0&&(this.termination=e.termination),e.date_payment_models?.forEach((e=>{this.date_payment_models.push(e)})),e.review_status&&(this.review_status=e.review_status,this.review_status_doc_id=e.id,this.review_status_instance_id=e.review_status_instance_id,this.review_status_value_instance_id=e.review_status_value_instance_id,this.review_status_notes=e.review_status_notes);this.agreement_terms&&(this.calcAgreementTermDates(this.agreement_terms,this.effective_date,this.operational_details,this.termination),this.calcAllTermPayments(),this.calcDatePayments(),this.calcEstimatedPurchasePrice()),this.amendments=t.filter((e=>e.amendment_date))}}findOtherDocs(e){this.effective_date&&(this.payment_directives=e.filter((e=>e.agreement_group===this.agreement_group&&e.payment_directive_date)),this.recorded_docs=e.filter((e=>e.agreement_group===this.agreement_group&&e.recorded_date)),this.letters=e.filter((e=>e.agreement_group===this.agreement_group&&e.letter_date)),this.deeds=e.filter((e=>e.agreement_group===this.agreement_group&&e.deed_date)),this.total_agreement_acres=this.property_description.reduce(((e,t)=>e+(t.agreement_acres||0)),0))}findDeeds(e){var t=e.filter((e=>"Deed"===e.document_type&&e.agreement_group&&e.agreement_group===this.agreement_group));"Deed"!==this.document_type&&t.length>0&&this.processDeedAmendments(t)}processDeedAmendments(e){const t=e[0],a=e.slice(1);a.sort(((e,t)=>new Date(e.amendment_date)-new Date(t.amendment_date))),a.forEach((e=>{e.effective_date&&(t.effective_date=e.effective_date),e.property_description&&(t.property_description=e.property_description)})),this.deed_count=e.length,this.deed_effective_date=t.effective_date?.toFormat("M/d/yyyy"),this.property_description=t.property_description,this.tags.includes("Purchased")||this.tags.push("Purchased")}qc(){if("Master Service Agreement"===this.document_type||this.termination?.termination_date)return;["agreement_group","document_type"].filter((e=>!this[e])).forEach((e=>this.qc_flags.push(`Missing ${e}`)));["project_id","project_name"].filter((e=>!this[e]&&null===this.amendment_date&&"Deed"!=this.document_type)).forEach((e=>this.qc_flags.push(`Missing ${e}`))),0===this.property_description.length&&null===this.amendment_date&&"Deed"!=this.document_type&&this.qc_flags.push("Missing Property Description"),this.property_description.length>0&&this.property_description.forEach(((e,t)=>{["county","state"].forEach((a=>{e[a]||this.qc_flags.push(`Missing ${a} on Property Description ${t+1}`)}))})),this.effective_date&&this.amendment_date?this.qc_flags.push("Docment has Effective Date AND Amendment Date"):this.effective_date||this.amendment_date||this.qc_flags.push("Document has no Effective Date OR Amendment Date"),this.tags.includes("Terminated")&&!this.termination?.termination_date&&this.qc_flags.push("Termination tag but no Termination Date"),this.tags.includes("Closed")&&!this.date_closed&&this.qc_flags.push("Closed tag but no Date Closed"),this.full_purchase_price&&!this.date_closed&&this.qc_flags.push("Purchase Price but no Date Closed"),this.agreement_terms&&this.agreement_terms.forEach(((e,t)=>{["term_length_years","term_ordinal","term_type"].forEach((a=>{e[a]||this.qc_flags.push(`Missing ${a} on Agreement Term ${t+1}`)})),e.payment_model&&!e.first_payment_start&&this.qc_flags.push(`Missing First Payment Start on Agreement Term ${t+1}`),e.first_payment_start&&!e.payment_model&&this.qc_flags.push(`Missing Payment Model on Agreement Term ${t+1}`)})),this.date_payment_models.length>0&&this.date_payment_models.forEach(((e,t)=>{["payment_type","payment_amount"].forEach((a=>{"payment_amount"===a&&0===e.payment_amount||e[a]||this.qc_flags.push(`Missing ${a} on Date Payment Model ${t+1}`)})),e.date_begin||e.date_one_time||this.qc_flags.push(`Missing Start Date OR One-time Date on Date Payment Model ${t+1}`),e.date_one_time||e.frequency||this.qc_flags.push(`Missing Frequency on Recurring Date Payment Model ${t+1}`),e.date_begin&&!e.date_end&&this.qc_flags.push(`Missing End Date on Recurring Date Payment Model ${t+1}`)})),this.term_payment_models&&this.term_payment_models.forEach(((e,t)=>{["model_type","payment_frequency"].forEach((a=>{e[a]||this.qc_flags.push(`Missing ${a} on Term Payment Model ${t+1}`)})),e.minimum_payment||e.flat_payment_amount||e.payment_per_mw||e.payment_per_mva||e.payment_per_acre||this.qc_flags.push(`Cannot calculate payment amount on Term Payment Model ${t+1}`),e.payment_per_acre&&!this.total_agreement_acres&&this.qc_flags.push(`Missing Total acres required for Term Payment Model ${t+1} $/acre calculation`)}))}nicknameGrantor(e){var t=[];if(e.toLowerCase().indexOf(" and ")>0&&t.push(e.toLowerCase().indexOf(" and ")),e.toLowerCase().indexOf(", ")>0&&t.push(e.toLowerCase().indexOf(",")),0===t.length)return e;var a=Math.min(...t);return e.substring(0,a)}cleanDoc(e){return["archivedBy","archivedOn","highlightedText","pageManipulationStatus","processingStatus","pages","securityLabelId","sourceDocumentId","sourceDocumentName","pageCount","thoughts","userIds"].forEach((t=>{delete e[t]})),e}}}();
