var JupiterDoc=function(){"use strict";const e=(e,t)=>{if(!t||0===t.length)return null;const a=e.payment_model??e.term_type;return a?t.find((e=>e.model_type===a)):t[0]},t=e=>e?Math.max(e.minimum_payment??0,(e.payment_per_mw??0)*(e.mw??0),(e.inverter_count??0)*(e.inverter_rating_mvas??0)*(e.payment_per_mva??0),e.flat_payment_amount??0,(e.payment_per_acre??0)*(e.leased_acres??0)):0,a=e=>e.toLowerCase().replace(/[\s()]+/g,"_").replace(/_+$/,"");var r=(a,r)=>{const d=[],s=e(a,r),n=t(s);if(!s)return null;var i,o,l=a.start_date,_=0,c=a.escalation_rate??0,m=s.periodic_escalation_rate??0;for(s.prorated_first_period&&0===_&&(i=+(o=new luxon.DateTime.local(a.start_date.year,12,31)).plus({days:1}).diff(a.start_date,"years").years.toFixed(2),d.push({payment_index:_,payment_date:a.start_date.plus({days:s.first_payment_due_days_after_term_start??0}).toLocaleString(),payment_period_end:o.toLocaleString(),prorata_years:i,base_payment:+(n*(1+c/100)).toFixed(2),total_payment_amount:+(n*(1+c*(a.term_ordinal-1)/100)*(1+m*(_+a.previous_periods)/100)*i).toFixed(2)}),l=new luxon.DateTime.local(a.start_date.year+1,1,1),_++);l<a.end_date;)i=+(o=(o=s.prorated_first_period?new luxon.DateTime.local(l.year,12,31):l.plus({years:1}).minus({days:1}))>a.end_date?a.end_date:o).plus({days:1}).diff(l,"years").years.toFixed(2),d.push({payment_index:_,payment_date:l.plus({days:0===_?s.first_payment_due_days_after_term_start??0:0}).toLocaleString(),payment_period_end:o.toLocaleString(),prorata_years:i,base_payment:+(n*(1+c/100)).toFixed(2),total_payment_amount:+(n*(1+c*(a.term_ordinal-1)/100)*(1+m*(_+a.previous_periods)/100)*i).toFixed(2)}),l=o.plus({days:1}),_++;d.sort(((e,t)=>e.payment_date-t.payment_date)),a.payments=d,a.cumulative_payment_amount=d.reduce(((e,t)=>e+t.total_payment_amount),0)},d=(e,t)=>{e.sort(((e,t)=>e.term_ordinal-t.term_ordinal)).forEach(((a,r)=>{a.start_date=e[r-1]?e[r-1].end_date.plus({days:1}):t,a.start_date_text=a.start_date.toFormat("M/d/yyyy"),a.end_date=a.start_date.plus({years:a.term_length_years}).plus({days:-1}),a.end_date_text=a.end_date.toFormat("M/d/yyyy"),a.previous_periods=e.filter((e=>e.term_ordinal<a.term_ordinal&&e.payment_model===a.payment_model)).reduce(((e,t)=>e+t.term_length_years),0)}))},s=(e,t)=>{e.facts&&e.facts.forEach((e=>{const a=t.find((t=>t.id===e.factTypeId));a&&(e.factTypeName=a.name,e.allowMultiple=a.allowMultiple,e.fieldCount=a.fieldTypes.length),e.fields&&e.fields.forEach((a=>{const r=t.find((t=>t.id===e.factTypeId)).fieldTypes.find((e=>e.id===a.factFieldTypeId));r&&(a.factTypeFieldName=r.name,a.dataType=r.dataType)}))}))},n=(e,t,a,r)=>{const d=e.facts?e.facts.find((e=>e.factTypeId==t)):null;if(d){const e=d.fields.find((e=>e.factFieldTypeId==a));if(e)switch(r){case"date":return new luxon.DateTime.fromISO(e.dateValue);case"number":return e.numberValue;case"string":return e.stringValue;case"bool":return e.booleanValue;default:return null}}return null},i=(e,t)=>{const r=e.facts?e.facts.filter((e=>e.factTypeId===t)):null;if(!r)return[];const d=[];return r.forEach((e=>{const t={};if(t.id=e.id,!e.fields)return t;e.fields.forEach((e=>{var r=a(e.factTypeFieldName),d="";switch(e.dataType){case"Number":d=e.numberValue;break;case"Date":d=new luxon.DateTime.fromISO(e.dateValue);break;case"String":case"SelectList":d=e.stringValue;break;case"Boolean":d=e.booleanValue}t[r]=d})),d.push(t)})),d},o=e=>(["archivedBy","archivedOn","highlightedText","pageManipulationStatus","processingStatus","pages","securityLabelId","sourceDocumentId","sourceDocumentName","pageCount","thoughts","userIds"].forEach((t=>{delete e[t]})),e);const l="cc05d0b7-005b-4775-a84d-e7cc98a7241f",_="7601840f-8d47-4c0b-a2a1-2ad2a692bfb8",c="e31c3090-21b0-4afd-877d-cf7eeed20673",m="cb93b25d-8bed-4865-8402-b2b3ded62af5";return class{constructor(e,t){o(e),s(e,t),this.rawDoc=e,this.id=e.id,this.name=e.name,this.effective_date=n(e,l,m,"date"),this.lease_terms=i(e,_),this.periodic_payment_models=i(e,c),d(this.lease_terms,this.effective_date),this.lease_terms.forEach((e=>{r(e,this.periodic_payment_models)}))}getId(){return this.id}getName(){return this.name}}}();
